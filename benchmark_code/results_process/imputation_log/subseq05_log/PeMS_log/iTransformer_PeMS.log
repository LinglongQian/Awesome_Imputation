2024-06-03 07:12:01 [INFO]: Have set the random seed as 2024 for numpy and pytorch.
2024-06-03 07:12:01 [INFO]: Using the given device: cuda:0
2024-06-03 07:12:01 [INFO]: Model files will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_0/20240603_T071201
2024-06-03 07:12:01 [INFO]: Tensorboard file will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_0/20240603_T071201/tensorboard
2024-06-03 07:12:01 [WARNING]: ‼️ d_model must = n_heads * d_k, it should be divisible by n_heads and the result should be equal to d_k, but got d_model=1024, n_heads=2, d_k=128
2024-06-03 07:12:01 [WARNING]: ⚠️ d_model is reset to 256 = n_heads (2) * d_k (128)
2024-06-03 07:12:02 [INFO]: iTransformer initialized with the given hyperparameters, the number of trainable parameters: 1,854,744
2024-06-03 07:12:16 [INFO]: Epoch 001 - training loss: 1.0402, validation loss: 1.0835
2024-06-03 07:12:23 [INFO]: Epoch 002 - training loss: 0.5658, validation loss: 1.0575
2024-06-03 07:12:30 [INFO]: Epoch 003 - training loss: 0.4599, validation loss: 1.1613
2024-06-03 07:12:37 [INFO]: Epoch 004 - training loss: 0.4062, validation loss: 1.1155
2024-06-03 07:12:44 [INFO]: Epoch 005 - training loss: 0.3799, validation loss: 1.0774
2024-06-03 07:12:51 [INFO]: Epoch 006 - training loss: 0.3474, validation loss: 1.1333
2024-06-03 07:12:59 [INFO]: Epoch 007 - training loss: 0.3133, validation loss: 1.1636
2024-06-03 07:13:05 [INFO]: Epoch 008 - training loss: 0.2977, validation loss: 1.1537
2024-06-03 07:13:12 [INFO]: Epoch 009 - training loss: 0.2871, validation loss: 1.1304
2024-06-03 07:13:19 [INFO]: Epoch 010 - training loss: 0.2762, validation loss: 1.1352
2024-06-03 07:13:26 [INFO]: Epoch 011 - training loss: 0.2711, validation loss: 1.1429
2024-06-03 07:13:33 [INFO]: Epoch 012 - training loss: 0.2640, validation loss: 1.1156
2024-06-03 07:13:33 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-06-03 07:13:33 [INFO]: Finished training. The best model is from epoch#2.
2024-06-03 07:13:33 [INFO]: Saved the model to results_subseq_rate05/PeMS/iTransformer_PeMS/round_0/20240603_T071201/iTransformer.pypots
2024-06-03 07:13:36 [INFO]: Successfully saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_0/imputation.pkl
2024-06-03 07:13:36 [INFO]: Round0 - iTransformer on PeMS: MAE=0.6531, MSE=1.4014, MRE=0.7718
2024-06-03 07:13:36 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2024-06-03 07:13:36 [INFO]: Using the given device: cuda:0
2024-06-03 07:13:36 [INFO]: Model files will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_1/20240603_T071336
2024-06-03 07:13:36 [INFO]: Tensorboard file will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_1/20240603_T071336/tensorboard
2024-06-03 07:13:36 [WARNING]: ‼️ d_model must = n_heads * d_k, it should be divisible by n_heads and the result should be equal to d_k, but got d_model=1024, n_heads=2, d_k=128
2024-06-03 07:13:36 [WARNING]: ⚠️ d_model is reset to 256 = n_heads (2) * d_k (128)
2024-06-03 07:13:36 [INFO]: iTransformer initialized with the given hyperparameters, the number of trainable parameters: 1,854,744
2024-06-03 07:13:43 [INFO]: Epoch 001 - training loss: 1.0441, validation loss: 1.1009
2024-06-03 07:13:50 [INFO]: Epoch 002 - training loss: 0.5833, validation loss: 1.0380
2024-06-03 07:13:57 [INFO]: Epoch 003 - training loss: 0.4663, validation loss: 1.1334
2024-06-03 07:14:04 [INFO]: Epoch 004 - training loss: 0.4041, validation loss: 1.1437
2024-06-03 07:14:11 [INFO]: Epoch 005 - training loss: 0.3794, validation loss: 1.1427
2024-06-03 07:14:18 [INFO]: Epoch 006 - training loss: 0.3421, validation loss: 1.1130
2024-06-03 07:14:25 [INFO]: Epoch 007 - training loss: 0.3199, validation loss: 1.1216
2024-06-03 07:14:33 [INFO]: Epoch 008 - training loss: 0.2978, validation loss: 1.1458
2024-06-03 07:14:40 [INFO]: Epoch 009 - training loss: 0.2929, validation loss: 1.1256
2024-06-03 07:14:47 [INFO]: Epoch 010 - training loss: 0.2895, validation loss: 1.1104
2024-06-03 07:14:54 [INFO]: Epoch 011 - training loss: 0.2867, validation loss: 1.1161
2024-06-03 07:15:00 [INFO]: Epoch 012 - training loss: 0.2710, validation loss: 1.1074
2024-06-03 07:15:00 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-06-03 07:15:00 [INFO]: Finished training. The best model is from epoch#2.
2024-06-03 07:15:00 [INFO]: Saved the model to results_subseq_rate05/PeMS/iTransformer_PeMS/round_1/20240603_T071336/iTransformer.pypots
2024-06-03 07:15:03 [INFO]: Successfully saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_1/imputation.pkl
2024-06-03 07:15:03 [INFO]: Round1 - iTransformer on PeMS: MAE=0.6423, MSE=1.3928, MRE=0.7590
2024-06-03 07:15:03 [INFO]: Have set the random seed as 2026 for numpy and pytorch.
2024-06-03 07:15:03 [INFO]: Using the given device: cuda:0
2024-06-03 07:15:03 [INFO]: Model files will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_2/20240603_T071503
2024-06-03 07:15:03 [INFO]: Tensorboard file will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_2/20240603_T071503/tensorboard
2024-06-03 07:15:03 [WARNING]: ‼️ d_model must = n_heads * d_k, it should be divisible by n_heads and the result should be equal to d_k, but got d_model=1024, n_heads=2, d_k=128
2024-06-03 07:15:03 [WARNING]: ⚠️ d_model is reset to 256 = n_heads (2) * d_k (128)
2024-06-03 07:15:04 [INFO]: iTransformer initialized with the given hyperparameters, the number of trainable parameters: 1,854,744
2024-06-03 07:15:11 [INFO]: Epoch 001 - training loss: 1.0643, validation loss: 1.2867
2024-06-03 07:15:18 [INFO]: Epoch 002 - training loss: 0.5382, validation loss: 1.1180
2024-06-03 07:15:25 [INFO]: Epoch 003 - training loss: 0.4441, validation loss: 1.1380
2024-06-03 07:15:32 [INFO]: Epoch 004 - training loss: 0.3957, validation loss: 1.1762
2024-06-03 07:15:39 [INFO]: Epoch 005 - training loss: 0.3580, validation loss: 1.0776
2024-06-03 07:15:46 [INFO]: Epoch 006 - training loss: 0.3299, validation loss: 1.0951
2024-06-03 07:15:53 [INFO]: Epoch 007 - training loss: 0.3057, validation loss: 1.1158
2024-06-03 07:15:59 [INFO]: Epoch 008 - training loss: 0.2926, validation loss: 1.1375
2024-06-03 07:16:06 [INFO]: Epoch 009 - training loss: 0.2935, validation loss: 1.1204
2024-06-03 07:16:14 [INFO]: Epoch 010 - training loss: 0.2876, validation loss: 1.0919
2024-06-03 07:16:20 [INFO]: Epoch 011 - training loss: 0.2932, validation loss: 1.1493
2024-06-03 07:16:28 [INFO]: Epoch 012 - training loss: 0.2733, validation loss: 1.1174
2024-06-03 07:16:35 [INFO]: Epoch 013 - training loss: 0.2587, validation loss: 1.1080
2024-06-03 07:16:42 [INFO]: Epoch 014 - training loss: 0.2534, validation loss: 1.1144
2024-06-03 07:16:48 [INFO]: Epoch 015 - training loss: 0.2498, validation loss: 1.1111
2024-06-03 07:16:48 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-06-03 07:16:48 [INFO]: Finished training. The best model is from epoch#5.
2024-06-03 07:16:49 [INFO]: Saved the model to results_subseq_rate05/PeMS/iTransformer_PeMS/round_2/20240603_T071503/iTransformer.pypots
2024-06-03 07:16:51 [INFO]: Successfully saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_2/imputation.pkl
2024-06-03 07:16:51 [INFO]: Round2 - iTransformer on PeMS: MAE=0.6432, MSE=1.3964, MRE=0.7601
2024-06-03 07:16:51 [INFO]: Have set the random seed as 2027 for numpy and pytorch.
2024-06-03 07:16:51 [INFO]: Using the given device: cuda:0
2024-06-03 07:16:51 [INFO]: Model files will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_3/20240603_T071651
2024-06-03 07:16:51 [INFO]: Tensorboard file will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_3/20240603_T071651/tensorboard
2024-06-03 07:16:51 [WARNING]: ‼️ d_model must = n_heads * d_k, it should be divisible by n_heads and the result should be equal to d_k, but got d_model=1024, n_heads=2, d_k=128
2024-06-03 07:16:51 [WARNING]: ⚠️ d_model is reset to 256 = n_heads (2) * d_k (128)
2024-06-03 07:16:51 [INFO]: iTransformer initialized with the given hyperparameters, the number of trainable parameters: 1,854,744
2024-06-03 07:16:58 [INFO]: Epoch 001 - training loss: 1.0887, validation loss: 1.0939
2024-06-03 07:17:04 [INFO]: Epoch 002 - training loss: 0.5913, validation loss: 1.0473
2024-06-03 07:17:10 [INFO]: Epoch 003 - training loss: 0.4790, validation loss: 1.0991
2024-06-03 07:17:17 [INFO]: Epoch 004 - training loss: 0.4158, validation loss: 1.1560
2024-06-03 07:17:23 [INFO]: Epoch 005 - training loss: 0.3721, validation loss: 1.1117
2024-06-03 07:17:29 [INFO]: Epoch 006 - training loss: 0.3503, validation loss: 1.1004
2024-06-03 07:17:36 [INFO]: Epoch 007 - training loss: 0.3191, validation loss: 1.1126
2024-06-03 07:17:42 [INFO]: Epoch 008 - training loss: 0.3102, validation loss: 1.1357
2024-06-03 07:17:48 [INFO]: Epoch 009 - training loss: 0.2942, validation loss: 1.1274
2024-06-03 07:17:55 [INFO]: Epoch 010 - training loss: 0.2894, validation loss: 1.0924
2024-06-03 07:18:01 [INFO]: Epoch 011 - training loss: 0.2806, validation loss: 1.1355
2024-06-03 07:18:07 [INFO]: Epoch 012 - training loss: 0.2671, validation loss: 1.0962
2024-06-03 07:18:07 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-06-03 07:18:07 [INFO]: Finished training. The best model is from epoch#2.
2024-06-03 07:18:07 [INFO]: Saved the model to results_subseq_rate05/PeMS/iTransformer_PeMS/round_3/20240603_T071651/iTransformer.pypots
2024-06-03 07:18:10 [INFO]: Successfully saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_3/imputation.pkl
2024-06-03 07:18:10 [INFO]: Round3 - iTransformer on PeMS: MAE=0.6431, MSE=1.3822, MRE=0.7600
2024-06-03 07:18:10 [INFO]: Have set the random seed as 2028 for numpy and pytorch.
2024-06-03 07:18:10 [INFO]: Using the given device: cuda:0
2024-06-03 07:18:10 [INFO]: Model files will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_4/20240603_T071810
2024-06-03 07:18:10 [INFO]: Tensorboard file will be saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_4/20240603_T071810/tensorboard
2024-06-03 07:18:10 [WARNING]: ‼️ d_model must = n_heads * d_k, it should be divisible by n_heads and the result should be equal to d_k, but got d_model=1024, n_heads=2, d_k=128
2024-06-03 07:18:10 [WARNING]: ⚠️ d_model is reset to 256 = n_heads (2) * d_k (128)
2024-06-03 07:18:10 [INFO]: iTransformer initialized with the given hyperparameters, the number of trainable parameters: 1,854,744
2024-06-03 07:18:17 [INFO]: Epoch 001 - training loss: 1.0450, validation loss: 1.2161
2024-06-03 07:18:23 [INFO]: Epoch 002 - training loss: 0.5680, validation loss: 1.1524
2024-06-03 07:18:29 [INFO]: Epoch 003 - training loss: 0.4525, validation loss: 1.1541
2024-06-03 07:18:35 [INFO]: Epoch 004 - training loss: 0.4058, validation loss: 1.0925
2024-06-03 07:18:42 [INFO]: Epoch 005 - training loss: 0.3723, validation loss: 1.0773
2024-06-03 07:18:48 [INFO]: Epoch 006 - training loss: 0.3388, validation loss: 1.1140
2024-06-03 07:18:54 [INFO]: Epoch 007 - training loss: 0.3167, validation loss: 1.1557
2024-06-03 07:19:00 [INFO]: Epoch 008 - training loss: 0.2981, validation loss: 1.0989
2024-06-03 07:19:07 [INFO]: Epoch 009 - training loss: 0.2852, validation loss: 1.1466
2024-06-03 07:19:13 [INFO]: Epoch 010 - training loss: 0.2807, validation loss: 1.1375
2024-06-03 07:19:19 [INFO]: Epoch 011 - training loss: 0.2782, validation loss: 1.0869
2024-06-03 07:19:25 [INFO]: Epoch 012 - training loss: 0.2699, validation loss: 1.1427
2024-06-03 07:19:32 [INFO]: Epoch 013 - training loss: 0.2614, validation loss: 1.0908
2024-06-03 07:19:38 [INFO]: Epoch 014 - training loss: 0.2518, validation loss: 1.1122
2024-06-03 07:19:44 [INFO]: Epoch 015 - training loss: 0.2452, validation loss: 1.1083
2024-06-03 07:19:44 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-06-03 07:19:44 [INFO]: Finished training. The best model is from epoch#5.
2024-06-03 07:19:44 [INFO]: Saved the model to results_subseq_rate05/PeMS/iTransformer_PeMS/round_4/20240603_T071810/iTransformer.pypots
2024-06-03 07:19:47 [INFO]: Successfully saved to results_subseq_rate05/PeMS/iTransformer_PeMS/round_4/imputation.pkl
2024-06-03 07:19:47 [INFO]: Round4 - iTransformer on PeMS: MAE=0.6347, MSE=1.3872, MRE=0.7501
2024-06-03 07:19:47 [INFO]: Done! Final results:
Averaged iTransformer (1,854,744 params) on PeMS: MAE=0.6433 ± 0.00585988799479946, MSE=1.3920 ± 0.006758796896392667, MRE=0.7602 ± 0.00692477723429646, average inference time=0.56
